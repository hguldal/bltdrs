    var onayliOgrencilerTablosu = $('#lstOnayliOgrenciler').DataTable({
        "pagingType": "simple",
        "language": {
            "url": ayarlar.datatablelangurl
        }
    });

    $('#cmbKabulSekli').val($('#cmbKabulSekli').attr('data-ilkdeger'));
    $('#cmbAramalardaGoster').val($('#cmbAramalardaGoster').attr('data-ilkdeger'));
    $('#cmbHaftalikSaat').val($('#cmbHaftalikSaat').attr('data-ilkdeger'));
    $('#cmbArsivlendi').val($('#cmbArsivlendi').attr('data-ilkdeger'));

    $('#lnkDersAdi').editable(
    {
        pk: function () {
            return $("#spnDersID").attr("data-DersID")
        },

        name: 'DersAdi',

        url: '/Ajax/Ders/DersAyarKaydet',

        display: function (value) {
            $(this).text(value + '');
        },

        success: function (msg) {

            MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);

        }
    });


    $('#lnkDersAdresKodu').editable(
    {
        pk: function () {
            return $("#spnDersID").attr("data-DersID")
        },

        name: '',

        url: '/Ajax/Ders/DersAdresKoduKaydet',

        display: function (value) {
            $(this).text(value + '');
        },

        success: function (msg) {
            $('#lnkDersAdresKodu').html(msg);
             MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);

        }
    });

    $('#lnkAciklama').editable({
        pk: function () {
            return $("#spnDersID").attr("data-DersID")
        },

        name: 'Aciklama',

        url: '/Ajax/Ders/DersAyarKaydet',

        display: function (value) {
            $(this).text(value + '');
        },

        success: function (msg) {

             MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);

        }
    });


    $('#cmbKabulSekli').selectize(
    {

        onItemAdd:
            function (data, $item) {
                var alan = 'KabulSekli';
                var DersID = $("#spnDersID").attr("data-DersID");
                var deger = data;
               
                $.ajax({
                    type: 'POST',
                    url: '/Ajax/Ders/DersAyarKaydet',
                    data: "pk=" + DersID + "&name=" + alan + '&value=' + deger,
                    success: function (msg) {
                         
                         MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);
                    },
                    error: function (msg) {
                         
                        HataMesaji(mesajlar.islemsirasindahata);
                    }
                });
               
            }
    }
    );


    $('#cmbAramalardaGoster').selectize(
    {

        onItemAdd:
            function (data, $item) {
                var alan = 'AramalardaGoster';
                var DersID = $("#spnDersID").attr("data-DersID");
                var deger = data;
               
                $.ajax({
                    type: 'POST',
                    url: '/Ajax/Ders/DersAyarKaydet',
                    data: "pk=" + DersID + "&name=" + alan + '&value=' + deger,
                    success: function (msg) {
                          
                         MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);
                    },
                    error: function (msg) {
                          
                         HataMesaji(mesajlar.islemsirasindahata);
                    }
                });
              
            }
    });

    $('#cmbArsivlendi').selectize(
    {

        onItemAdd:
            function (data, $item) {
                var alan = 'Arsivlendi';
                var DersID = $("#spnDersID").attr("data-DersID");
                var deger = data;
               
                $.ajax({
                    type: 'POST',
                    url: '/Ajax/Ders/DersAyarKaydet',
                    data: "pk=" + DersID + "&name=" + alan + '&value=' + deger,
                    success: function (msg) {
                         
                         MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);
                    },
                    error: function (msg) {
                         
                        HataMesaji(mesajlar.islemsirasindahata);
                    }
                });
               
            }
    });


    $('#cmbHaftalikSaat').selectize(
    {

        onItemAdd:
            function (data, $item) {
                var alan = 'HaftalikSaat';
                var DersID = $("#spnDersID").attr("data-DersID");
                var deger = data;
               
                $.ajax({
                    type: 'POST',
                    url: '/Ajax/Ders/DersAyarKaydet',
                    data: "pk=" + DersID + "&name=" + alan + '&value=' + deger,
                    success: function (msg) {
                         
                        MesajKutusu(mesajlar.islemtamam, mesajlar.dersayarlarikaydedildi);
                    },
                    error: function (msg) {
                         
                        HataMesaji(mesajlar.islemsirasindahata);
                    }
                });
               
            }
    });



    var $ogrenciler = $('#txtOgrenciler').selectize({

        valueField: 'userID',
        labelField: 'adsoyad',
        searchField: 'adsoyad',
        options: [],
        create: false,
        render: {
            option: function (item, escape) {

                return '<div class="media">' +
                            '<a class="pull-left" href="#">' +
                            '<img class="media-object img-circle" src="http://bulutders.blob.core.windows.net/profilresimleri/' + escape(item.Avatar) + '" width="48" height="48">' +
                            '</a>' +

                            '<div class="media-body">' +
                                '<h5 class="media-heading">' + escape(item.adsoyad) + '</h5>' +

                            '</div>' +
                            '</div>';

            }
        },

        load: function (query, callback) {
            if (!query.length) return callback();

            $.ajax({
                url: '/Ajax/JsonKisiListesi.cshtml',
                data: {
                    sorgu: query
                },
                dataType: 'json',
                type: 'GET',
                error: function () {
                    alert('hata');
                    callback();
                },
                success: function (res) {
                    callback(res);
                }
            });
        },

        onItemAdd:
            function (data, $item) {

                var DersID = $("#spnDersID").attr("data-DersID");
                var control = $ogrenciler[0].selectize;

                var UserID = control.getValue();
                var ogrenciAdiSoyadi = control.getItem(control.getValue()).text();



                $.ajax({
                    type: 'POST',
                    url: '/Ajax/DersTakip/ErisimIzniVer',
                    data: "DersID=" + DersID + "&UserID=" + UserID,
                    success: function (msg) {
                        var eHtml = String.format('<tr><td>{0}</td><td><button class="btn btn-danger erisimiDurdur">{1}</button></td></tr>', ogrenciAdiSoyadi, mesajlar.durdur);
                        $('#lstOnayliOgrenciler > tbody').prepend(eHtml);
                        control.clear();
                    },
                    error: function (msg) {
                         HataMesaji(mesajlar.beklenmeyenhata);
                    }
                });



            }

    });




    var tabloDersTakip = $('#lstDersTakip').DataTable({
    "pagingType": "simple",
    "language": {
        "url": ayarlar.datatablelangurl
    },
    "bPaginate": true,
    "bLengthChange": false,
    "bFilter": true,
    "bInfo": false,
    "bSort": false
});

$('body').on('click', '.btnDersiTakipEt', function () {

    var DersID = $(this).attr('data-DersID');

    var dugme = $(this);

    $.ajax({
        type: 'POST',
        url: '/Ajax/DersTakip/DersiTakipEt',
        data: "DersID=" + DersID,
        success: function (msg) {
            if (msg == 'derstakipediliyor') {
                location.href = "/Ders/?DersID=" + DersID;
            }
            else if (msg == 'takipistegigonderildi') {
                
                MesajKutusu(mesajlar.islemtamam, mesajlar.takipistegigonderildi);
            }
        },
        error: function (msg) {
            if (msg.status == 501) {
                console.log(msg.status);
                HataMesaji(mesajlar.derstakipediliyorveyaistekgonderilmis);
            }
            else {
                HataMesaji(mesajlar.islemsirasindahata);
            }
        }
    });


});

$('body').on('click', '.btnDersTakipOnayVer', function () {

    var DersID = $(this).attr('data-DersID');
    var UserID = $(this).attr('data-UserID');
    var satir = $(this).closest('tr');
    
    $.ajax({
        type: 'POST',
        url: '/Ajax/DersTakip/Onayla',
        data: "DersID=" + DersID + "&UserID=" + UserID,
        success: function (msg) {
            $(satir).animate({ backgroundColor: 'gray' }, 150).fadeOut(150, function () {
                $(satir).remove();
                
            });
            
            MesajKutusu(mesajlar.islemtamam,mesajlar.ogrencibasariylaonaylandi);
        },
        error: function (msg) {
             
            HataMesaji(mesajlar.islemsirasindahata);
        }
    });
   

});


$('body').on('click', '.btnDersTakipEngelle', function () {

    var DersID = $(this).attr('data-DersID');
    var UserID = $(this).attr('data-UserID');
    var satir = $(this).closest('tr');
    var row = tabloDersTakip.row($(this).parents('tr'));
     if (confirm(mesajlar.ogrencierisimdurdurulacak))
     { 
       
         $.ajax({
        type: 'POST',
        url: '/Ajax/DersTakip/Engelle',
        data: "DersID=" + DersID + "&UserID=" + UserID,
        success: function (msg) {
             row.remove().draw();
              
            MesajKutusu(mesajlar.islemtamam,mesajlar.ogrenciderseerisimdurduruldu);
        },
        error: function (msg) {
             
           HataMesaji(mesajlar.islemsirasindahata);
        }
    });
   
     }
    

});



$('body').on('click', '.btnDersTakibiBirak', function () {

    var DersID = $(this).attr('data-DersID');
    if (confirm('Emin misiniz ?')) {
        
        $.ajax({
            type: 'POST',
            url: '/Ajax/DersTakip/TakibiBirak',
            data: "DersID=" + DersID,
            success: function (msg) {
                location.href = "/Panel";
            },
            error: function (msg) {
                
               HataMesaji(mesajlar.islemsirasindahata);
            }
        });
        
    }

});



$('body').on('click', '.btnDersTakipReddet', function () {

    var DersID = $(this).attr('data-DersID');
    var UserID = $(this).attr('data-UserID');
    var satir = $(this).closest('tr');
    
    $.ajax({
        type: 'POST',
        url: '/Ajax/DersTakip/Reddet',
        data: "DersID=" + DersID + "&UserID=" + UserID,
        success: function (msg) {
            $(satir).animate({ backgroundColor: 'gray' }, 150).fadeOut(150, function () {
                $(satir).remove();
                 
            });

        },
        error: function (msg) {
             
            HataMesaji(mesajlar.islemsirasindahata);
        }
    });
   

});

var $ogrenciler = $('#txtOgrenciler').selectize({

    valueField: 'userID',
    labelField: 'adsoyad',
    searchField: 'adsoyad',
    options: [],
    create: false,
    render: {
        option: function (item, escape) {

            return '<div class="media">' +
                            '<a class="pull-left" href="#">' +
                            '<img class="media-object img-circle" src="http://bulutders.blob.core.windows.net/profilresimleri/' + escape(item.Avatar) + '" width="48" height="48">' +
                            '</a>' +

                            '<div class="media-body">' +
                                '<h5 class="media-heading">' + escape(item.adsoyad) + '</h5>' +

                            '</div>' +
                            '</div>';

        }
    },

    load: function (query, callback) {
        if (!query.length) return callback();
        
        $.ajax({
            url: '/Ajax/JsonOgrenciListesi.cshtml',
            data: {
                sorgu: query
            },
            dataType: 'json',
            type: 'GET',
            error: function () {
                
                alert('hata');
                callback();
            },
            success: function (res) {
                
                callback(res);
            }
        });
        
    },

    onItemAdd:
            function (data, $item) {

                var DersID = $("#divDersRow").attr("data-DersID");
                var control = $ogrenciler[0].selectize;

                var UserID = control.getValue();
                var ogrenciAdiSoyadi = control.getItem(control.getValue()).text();
                
                $.ajax({
                    type: 'POST',
                    dataType: "json",
                    url: '/Ajax/DersTakip/ErisimIzniVer',
                    data: "DersID=" + DersID + "&UserID=" + UserID,
                    success: function (msg) {
                         tabloDersTakip.row.add([
                             '<span><img src="http://bulutders.blob.core.windows.net/profilresimleri/' + msg.Avatar +'" class="img-circle" style="width:48px;height: 48px"> <a href="#"> ' + msg.Ad + ' ' + msg.Soyad + '</a></span>',
                            'Az Önce',
                            '<button class="btn btn-danger btnDersTakipEngelle btn-sm" data-DersID="'+ DersID +'" data-UserID="' + UserID +'"><i class="fa fa-remove"></i></button>'
                        ]).draw();
                        control.clear();
                         
                    },
                    error: function (msg) {
                         
                        HataMesaji(mesajlar.islemsirasindahata);
                    }
                });
               


            }

});

var tabloDersDosyalari = $('#lstDersDosyalari').DataTable({
    "pagingType": "simple",
    "language": {
        "url": ayarlar.datatablelangurl
    },
    "bPaginate": true,
    "bLengthChange": false,
    "bFilter": false,
    "bInfo": false,
    "bSort": false
});

$('body').on('click', '.btnDosyayiCikar', function () {

    var DosyaID = $(this).attr('data-DosyaID');
    var DersID = $("#divDersRow").attr("data-DersID");
    var row = tabloDersDosyalari.row($(this).parents('tr'));
    if (confirm(mesajlar.erisimiznikaldirilacak)) {
       
        $.ajax({
            type: 'POST',
            url: '/Ajax/Dosya/ErisimIzniniKaldirDers',
            data: "DersID=" + DersID + "&DosyaID=" + DosyaID,
            success: function (msg) {
                 row.remove().draw();
                  
            },
            error: function (msg) {
                 
                HataMesaji(mesajlar.islemsirasindahata);
            }
        });
       
    }

});




var $dosyalar = $('#txtDosyalarimdanBul').selectize({

        valueField: 'DosyaID',
        labelField: 'DosyaAdi',
        searchField: 'DosyaAdi',
        options: [],
        create: false,
        render: {
            option: function (item, escape) {

                return '<div class="media">' +
                            '<a class="pull-left" href="#">' +

                            '</a>' +

                            '<div class="media-body">' +
                                '<h5 class="media-heading">' + escape(item.Aciklama) + '</h5>' +
                                '<small>' + escape(item.DosyaAdi) + '</small>' +

                            '</div>' +
                            '</div>';

            }
        },

        load: function (query, callback) {
            if (!query.length) return callback();
            $.ajax({
                url: '/Ajax/Dosya/JsonDosyaListesi.cshtml',
                data: {
                    sorgu: query
                },
                dataType: 'json',
                type: 'GET',
                error: function () {
                    alert('hata');
                    callback();
                },
                success: function (res) {
                    callback(res);
                }
            });
        },

        onItemAdd:
            function (data, $item) {

                var DersID = $("#divDersRow").attr("data-DersID");
                var control = $dosyalar[0].selectize;

                var DosyaID = control.getValue();
                $('#modalDerseDosyaEkle').modal('hide');
                
                $.ajax({
                    type: 'POST',
                    url: '/Ajax/Ders/DosyaEkle',
                    dataType: "json",
                    data: "DosyaID=" + DosyaID + "&DersID=" + DersID,
                    success: function (msg) {
                        
                            var boyut = "";
                            if (msg.Boyut < 1048576) {
                                boyut = Math.round(msg.Boyut / 1024) + ' KB';
                            }
                            else {
                                boyut = Math.round(msg.Boyut / 1048576) + ' MB';
                            }
                            tabloDersDosyalari.row.add([
                            '<i class="fa fa-file-text-o fa-2x text-success"></i> ' + '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '">' + msg.Aciklama + '</a> ',
                            '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '" >' + msg.DosyaAdi + '</a>',
                            boyut,
                            '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '" class="btn btn-info"><i class="fa fa-cloud-download"></i></a> ' +
                            '<a href="/Dosya/Ayarlar?DosyaID=' + msg.DosyaID + '" class="btn btn-warning"><i class="fa fa-cog"></i></a> ' +
                            '<button class="btn btn-danger btnDosyayiCikar" data-DosyaID="' + msg.DosyaID + '"><i class="fa fa-remove"></i></button> '

                        ]).draw();
                            
                            MesajKutusu(mesajlar.islemtamam, mesajlar.dosyabasariylaeklendi);
                            control.clear();
                        
                    },
                    error: function (msg) {
                         control.clear(); 
                         
                        if (msg.status == 501) {
                            

                            HataMesaji(mesajlar.dosyazatenekli);
                        }
                        else {
                            
                            HataMesaji(mesajlar.islemsirasindahata);
                        }

                    }
                });
               

            }

    });


var maxBlockSize = 1 * 1024 * 1024;
var numberOfBlocks = 1;
var selectedFile = null;
var currentFilePointer = 0;
var totalBytesRemaining = 0;
var blockIds = new Array();
var blockIdPrefix = "block-";
var submitUri = null;
var bytesUploaded = 0;
var yVarmi = true;
var azureDosyaAdi = '';

$("#txtDosya").change(function () {
           var file = this.files[0];
           name = file.name;
           size = file.size;
           type = file.type;

           if (size > 200000000) {
               $("#txtDosya").val('');
               HataMesaji(mesajlar.dosyaboyutubuyuk);
           }
           else {
              
               $.ajax({
                   type: 'POST',
                   url: '/Ajax/Dosya/Yervarmi',
                   data: "DosyaBoyut=" + size,
                   success: function (msg) {
                       yVarmi = true;
                   },
                   error: function (msg) {
                       if (msg.status == 502) {
                           $("#txtDosya").val('');
                           yVarmi = false;
                            
                           HataMesaji(mesajlar.dosyaicinyetersizalan);
                       }
                       else {
                            
                           HataMesaji(mesajlar.dosyaeklenirkenhata);
                       }
                   }
               });
              
           }

       });

$('#btnDosyaEkle').click(function () {

           var file = $('#txtDosya')[0].files[0];

           if (file == null) {
               $('#txtDosya').focus();
               HataMesaji(mesajlar.dosyasecilmedi);
               return false;
           }
           $('#modalDerseDosyaEkle').modal('hide');
           handleFileSelect();
          

           $.ajax({
               type: 'GET',
               url: '/Ajax/Dosya/YeniGuid',
               success: function (res) {

                   azureDosyaAdi = res + '.' + selectedFile.name.substr(selectedFile.name.lastIndexOf('.') + 1);


                   $.ajax({
                       type: 'GET',
                       url: '/Ajax/Dosya/AzureSaSOlustur?AzureDosyaAdi=' + azureDosyaAdi,

                       success: function (res) {
                           submitUri = res;
                           uploadFileInBlocks();

                       },
                       error: function (res, status, xhr) {
                           HataMesaji("Microsoft Azure: Can't get the Shared Access Signature");
                       }
                   });

               },
               error: function (res) {
                   HataMesaji(mesajlar.dosyaeklenirkenhata);
                   return false;
               }
           });

       });


function handleFileSelect() {
           maxBlockSize = 1 * 1024 * 1024;
           currentFilePointer = 0;
           totalBytesRemaining = 0;

           selectedFile = $('#txtDosya')[0].files[0];

           var fileSize = selectedFile.size;
           if (fileSize < maxBlockSize) {
               maxBlockSize = fileSize;

           }
           totalBytesRemaining = fileSize;
           if (fileSize % maxBlockSize == 0) {
               numberOfBlocks = fileSize / maxBlockSize;
           } else {
               numberOfBlocks = parseInt(fileSize / maxBlockSize, 10) + 1;
           }

       }

var reader = new FileReader();

reader.onloadend = function (evt) {
    if (evt.target.readyState == FileReader.DONE) {
        var uri = submitUri + '&comp=block&blockid=' + blockIds[blockIds.length - 1];
        var requestData = new Uint8Array(evt.target.result);
        $.ajax({
            url: uri,
            type: "PUT",
            data: requestData,
            processData: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader('x-ms-blob-type', 'BlockBlob');

            },
            success: function (data, status) {
                bytesUploaded += requestData.length;
                var percentComplete = ((parseFloat(bytesUploaded) / parseFloat(selectedFile.size)) * 100).toFixed(1);
                $('#uploadProgress').attr('value', percentComplete);

                uploadFileInBlocks();
            },
            error: function (xhr, desc, err) {
                HataMesaji(desc);
            }
        });
    }
};

function uploadFileInBlocks() {
           if (totalBytesRemaining > 0) {

               var fileContent = selectedFile.slice(currentFilePointer, currentFilePointer + maxBlockSize);
               var blockId = blockIdPrefix + pad(blockIds.length, 6);

               blockIds.push(btoa(blockId));
               reader.readAsArrayBuffer(fileContent);
               currentFilePointer += maxBlockSize;
               totalBytesRemaining -= maxBlockSize;
               if (totalBytesRemaining < maxBlockSize) {
                   maxBlockSize = totalBytesRemaining;
               }
           } else {
               commitBlockList();
           }
       }

function commitBlockList() {
           var uri = submitUri + '&comp=blocklist';

           var requestBody = '<?xml version="1.0" encoding="utf-8"?><BlockList>';
           for (var i = 0; i < blockIds.length; i++) {
               requestBody += '<Latest>' + blockIds[i] + '</Latest>';
           }
           requestBody += '</BlockList>';

           $.ajax({
               url: uri,
               type: "PUT",
               data: requestBody,
               beforeSend: function (xhr) {
                   xhr.setRequestHeader('x-ms-blob-content-type', selectedFile.type);

               },
               success: function (data, status) {
                   console.log(data);
                   console.log(status);
                   var aciklama = $('#txtAciklama').val();
                   var dersID = $('#txtDersID').val();
                   DosyayiYukleDerseKaydet(dersID, selectedFile.name, selectedFile.size, selectedFile.type, azureDosyaAdi, aciklama);
                   
               },
               error: function (xhr, desc, err) {
                   console.log(desc);
                   console.log(err);
                   HataMesaji(mesajlar.dosyaeklenirkenhata + ' ' + desc);
               }
           });

       }
function pad(number, length) {
           var str = '' + number;
           while (str.length < length) {
               str = '0' + str;
           }
           return str;
       }
function DosyayiYukleDerseKaydet(DersID,dosyaAdi, dosyaBoyut, dosyaTuru, azureDosyaAdi, aciklama) {

    $.ajax({
        type: 'POST',
        dataType: 'json',
        url: '/Ajax/Ders/DosyaYukleEkle?DersID=' + DersID + '&AzureDosyaAdi=' + azureDosyaAdi + '&Aciklama=' + aciklama + '&DosyaBoyut=' + dosyaBoyut + '&DosyaAdi=' + dosyaAdi + '&DosyaTuru=' + dosyaTuru,
        success: function (msg) {
            
            tabloDersDosyalari.row.add([
                            '<i class="fa fa-file-text-o fa-2x text-success"></i> ' + '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '">' + msg.Aciklama + '</a> ',
                            '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '" >' + msg.DosyaAdi + '</a>',
                            dosyaBoyut,
                            '<a href="/Dosya/Indir?DosyaID=' + msg.DosyaID + '" class="btn btn-info btn-sm"><i class="fa fa-cloud-download"></i></a> ' +
                            '<a href="/Dosya/Ayarlar?DosyaID=' + msg.DosyaID + '" class="btn btn-warning btn-sm"><i class="fa fa-cog"></i></a> ' +
                            '<button class="btn btn-danger btnDosyayiCikar btn-sm" data-DosyaID="' + msg.DosyaID + '"><i class="fa fa-remove"></i></button> '

                        ]).draw();
         
            MesajKutusu(mesajlar.islemtamam, mesajlar.dosyabasariylaeklendi);
            $('#txtDosya').val('');

        },
        error: function (msg) {
             
            if (msg.status == 502) {
                HataMesaji(mesajlar.dosyaicinyetersizalan);
            }
            else {
                HataMesaji(mesajlar.dosyaeklenirkenhata);
            }

        }
    });

    }


$('#btnDersEkle').click(function () {

    var dersAdi = $('#txtDersAdi').val();
    var aciklama = $('#txtDersAciklama').val();
    var kabulSekli = $('#cmbKabulSekli').val();
    var aramalardaGoster = $('#cmbAramalardaGoster').val();

    if (dersAdi == '') {

        HataMesaji(mesajlar.dersadigirilmedi);
        $('#txtDersAdi').focus();
        return false;
    }
    $('#modalDersEkle').modal('hide');

    $.ajax({
        type: 'POST',
        url: '/ajax/Ders/Ekle',
        data: "DersAdi=" + encodeURIComponent(dersAdi) + "&Aciklama=" + encodeURIComponent(aciklama) + '&KabulSekli=' + kabulSekli + '&AramalardaGoster=' + aramalardaGoster,
        success: function (msg) {

            var eklenecekHtml = '';
            eklenecekHtml = '<tr>' +

                    '<td><h4><i class="fa fa-book"></i> <a href="/Ders/?DersID=' + msg.DersID + '"> ' + msg.DersAdi + ' </a></h4>  </td>' +
            '<td>' +

            '<div class="dropdown">' +


            '<button id="dLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-xs">' +
            '<i class="fa fa-cog"></i>' +
            '<span class="caret"></span>' +
            '</button>' +

            '<ul class="dropdown-menu" aria-labelledby="dLabel">' +
            '<li><a href="/Ders/?DersID=' + msg.DersID + '"><i class="fa fa-search-plus"></i> ' + mesajlar.gozat + '</a></li>' +
            '<li><a href="#" class="btnDersSil" data-DersID="' + msg.DersID  +'"><i class="fa fa-times"></i> ' + 'Dersi Sil' + '</a></li>' +
            '<li><a href="/Ders/Ayarlar/?DersID=' + msg.DersID + '"><i class="fa fa-gear"></i> ' + mesajlar.ayarlar + '</a></li>' +
            '</ul>' +
            '</div>' +

            '</td>' +
            '<td>' + $('#divAktifKullaniciKucukKunye').html() + '</td>' +

            '<td>0</td>' +

            '<td><i class="fa fa-check-circle fa-2x text-success" title=""></i></td>' +

            '</tr>';
            
            $('#lstDersler tbody').prepend(eklenecekHtml);


            MesajKutusu(mesajlar.tamam, dersAdi + mesajlar.dersiolusturuldu);
            $('#txtDersAdi').val('');
            $('#txtDersAciklama').val('');

        },
        error: function (msg) {

            if (msg.status == 501) {
                HataMesaji(mesajlar.dersadibos);
            }

        }
    });

});

$('#chkArsivdekiDersleriGoster').click(function () {
    if (this.checked) {
        location.href = '/Ders/Liste?ArsivdekileriGoster=1';
    }
    else
    {
       location.href = '/Ders/Liste'; 
    }
});

$('body').on('click', '.btnDersTakibiBirak', function () {

    var DersID = $(this).attr('data-DersID');

    var satir = $(this).closest('tr');
    if (confirm(mesajlar.derstakibirakilacak)) {

        $.ajax({
            type: 'POST',
            url: '/Ajax/DersTakip/TakibiBirak',
            data: "DersID=" + DersID,
            success: function (msg) {
                       $(satir).animate({ backgroundColor: 'gray' }, 150).fadeOut(150, function () {
                        $(satir).remove();
                    });

            },
            error: function (msg) {

                HataMesaji(mesajlar.islemsirasindahata);
            }
        });

    }
});


$('body').on('click', '.btnDersSil', function () {

    var DersID = $(this).attr('data-DersID');

    var satir = $(this).closest('tr');
    if (confirm('Ders kalıcı olarak silinecek.Emin misiniz?')) {

        $.ajax({
            type: 'POST',
            url: '/Ajax/Ders/DersSil',
            data: "DersID=" + DersID,
            success: function (msg) {
                       $(satir).animate({ backgroundColor: 'gray' }, 150).fadeOut(150, function () {
                        $(satir).remove();
                    });

            },
            error: function (msg) {

                HataMesaji(mesajlar.islemsirasindahata);
            }
        });

    }
});

$('#btnDersAra').click(function () {
   
    $('#txtAra').focus();
});


$('#btnDerseKatil').click(function () {
    var erisimKodu = $('#txtErisimKodu').val();

    if (!erisimKodu) {
        HataMesaji(mesajlar.erisimkodugirilmedi);
        $('#txtErisimKodu').focus();
        return false;
    }
    console.log(erisimKodu);
    $.ajax({
        type: 'POST',
        url: '/Ajax/DersTakip/ErisimKoduIleDerseKatil',
        data: "ErisimKodu=" + erisimKodu,
        success: function (msg) {
            location.href = "/Ders/?DersID=" + msg;
        },
        error: function (msg) {

            HataMesaji(mesajlar.dersekatilimbasarisizoldu);
        }
    });
});

$('#btnPanoMesajiGonder').click(function () {
        var DersID = $("#divDersRow").attr("data-DersID");
        var mesajMetni = $("#txtPanoMesaji").val();
        if (mesajMetni == '') {
            $("#txtPanoMesaji").focus();
            return false;
        }
       
        $.ajax({
            type: 'POST',
            url: '/Ajax/Ders/PanoyaMesajEkle',
            data: "DersID=" + DersID + "&MesajMetni=" + encodeURIComponent(mesajMetni),
            success: function (msg) {
                var eklenecekHtml = '<tr>' +
                '<td>' + $("#divAktifKullaniciKucukKunye").html() + '</td>' +
                '<td>' + mesajMetni + '</td>' +
                '<td class="text-right"> ' + mesajlar.azonce + ' </td>' +
                '<td class="text-right">' + '<button class="btn btn-danger btn-xs panoOgesiSil" data-PanoOgeID="' + msg + '"><i class="fa fa-remove"></i></button>' + '</td>'

                + '</tr>';
                $('#tableDersPanosu').prepend(eklenecekHtml);
                $("#txtPanoMesaji").val('');
                 
            },
            error: function (msg) {
                 
                HataMesaji(mesajlar.mesajpaylasilirkenhata);
            }
        });
       
    });



$('body').on('click', '.panoOgesiSil', function () {

        var ID = $(this).attr('data-PanoOgeID');
        var satir = $(this).closest('tr');
        if (confirm(mesajlar.mesajsilinecek)) {
            $.ajax({
                type: 'POST',
                url: '/Ajax/Ders/PanodanMesajSil',
                data: "ID=" + ID,
                success: function (msg) {
                    $(satir).animate({ backgroundColor: 'gray' }, 150).fadeOut(150, function () {
                        $(satir).remove();
                    });

                },
                error: function (msg) {
                    HataMesaji(mesajlar.islemsirasindahata);
                }
            });
        }

    });

    var tabloOdevListesi = $('#lstOdevler').DataTable({
        "pagingType": "simple",
        "language": {
            "url": ayarlar.datatablelangurl
        },
        "bPaginate": true,
        "bLengthChange": false,
        "bFilter": false,
        "bInfo": false,
        "bSort": false
    });


    $('input[name="SonTeslimTarihi"]').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true,
        format: ayarlar.dtformat,
        drops: 'down',
        buttonClasses: ['btn', 'btn-sm'],
        applyClass: 'btn-primary',
        cancelClass: 'btn-default',
        locale: ayarlar.dtpickerlocale
    },
    function (start, end, label) {

    });

    $('#btnOdevVer').click(function () {

        var dosyadanTabSecili = $('#tabDosyalar').hasClass('active');

        if (dosyadanTabSecili) {
            $('#txtBilgisayardanDosya').val('');

        }
        else {
            $('#txtDosyalardanDosyaID').val('');
        }

        var odevBaslik = $('#txtOdevBaslik').val();

        if (odevBaslik == '') {
            $('#txtOdevBaslik').focus();
            HataMesaji(mesajlar.basliksecilmedi);
            return false;
        }
       
        $('#modalDerseOdevVer').modal('hide');
       
        $("#frmOdevEkle").ajaxSubmit({
            url: '/Ajax/Odev/OdevVer',
            dataType: "json",
            type: 'post',
            success: function (msg) {

                tabloOdevListesi.row.add([
                            '<i class="fa fa-clock-o fa-2x text-success"></i> ' + '<a href="/Odev/Goster?OdevID=' + msg.OdevID + '">' + msg.Baslik + '</a> ',
                           '<a href="/Odev/Goster?OdevID=' + msg.OdevID + '" class="btn btn-info" title="' + mesajlar.gozat +'"><i class="fa fa-search-plus"></i></a> ' +
                            '<a href="/Odev/Ayarlar?OdevID=' + msg.OdevID + '" class="btn btn-warning" title="' + mesajlar.odevayarlari +'"><i class="fa fa-cog"></i></a> ' +
                            '<a href="/Odev/OdevGonderileri?OdevID=' + msg.OdevID + '" class="btn btn-primary" title="' + mesajlar.odevinigonderenler +'"><i class="fa fa-user"></i></a> ' +
                            '<button class="btn btn-danger btnOdevSil" data-OdevID="' + msg.OdevID + '"><i class="fa fa-remove"></i></button> '

                        ]).draw();

                 
                MesajKutusu(mesajlar.islemtamam, mesajlar.odevbasariylaolusturuldu);
            },

            error: function () {
                 
                HataMesaji(mesajlar.odeveklenirkenhata);
            }

        });
       


    });

    $('body').on('click', '.btnOdevSil', function () {
        var OdevID = $(this).attr('data-OdevID');

        var row = tabloOdevListesi.row($(this).parents('tr'));
        if (confirm(mesajlar.odevsilinecek)) {

            $.ajax({
                type: 'POST',
                url: '/Ajax/Odev/OdevSil',
                data: "OdevID=" + OdevID,
                success: function (msg) {

                    row.remove().draw();
                },
                error: function (msg) {
                    HataMesaji(mesajlar.islemsirasindahata);
                }
            });
        }
    });


    var $dosyalar = $('#txtDosyalardanDosya').selectize({

        valueField: 'DosyaID',
        labelField: 'DosyaAdi',
        searchField: 'DosyaAdi',
        options: [],
        create: false,
        render: {
            option: function (item, escape) {

                return '<div class="media">' +
                            '<a class="pull-left" href="#">' +

                            '</a>' +

                            '<div class="media-body">' +
                                '<h5 class="media-heading"><strong>' + escape(item.Aciklama) + '</strong></h5>' +
                                '<small>' + escape(item.DosyaAdi) + '</small>' +

                            '</div>' +
                            '</div>';

            }
        },

        load: function (query, callback) {
            if (!query.length) return callback();
            
            $.ajax({
                url: '/Ajax/Dosya/JsonDosyaListesi.cshtml',
                data: {
                    sorgu: query
                },
                dataType: 'json',
                type: 'GET',
                error: function () {
                    
                     HataMesaji(mesajlar.islemsirasindahata);
                    callback();
                },
                success: function (res) {
                    
                    callback(res);
                }
            });
            
        },

        onItemAdd:
            function (data, $item) {
               
            }

    });