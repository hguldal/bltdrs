@{
    
/*----------------------------------------------------------------------------------
    Bu prosedür ders panosuna bir mesaj ekler.
    Bu prosedürü sadece dersin sahibi ve dersin takipçisi çalıştırabilir.
  ---------------------------------------------------------------------------------*/
    if (!WebSecurity.IsAuthenticated)
   
        {
            Response.StatusCode=401;
            Response.End();
                   
        }  
   // DersID ve mesaj metnini oku
    var DersID=Request["DersID"];
    var mesajMetni=Request["MesajMetni"];

    // DersID boş olamaz. Eğer boşsa hata kodu döndür.
    if (string.IsNullOrEmpty(DersID))
     {
    
       Response.StatusCode=500;
       Response.End();
     }

     // Mesaj metni de boş olamaz. Eğer boşsa hata kodu döndür.
     if (string.IsNullOrEmpty(mesajMetni))
     {
    
       Response.StatusCode=500;
       Response.End();
     }


     var db=Database.Open("fb1ae");
 
       var queryIslem=db.QueryValue("exec dbo.Ders_PanoyaMesajEkle @0,@1,@2,@3",WebSecurity.CurrentUserId,DersID,mesajMetni);

    if (queryIslem>0)
    {
        db.Close();
        Response.Write(queryIslem);
        Response.End();    
    }
    else
    {
        db.Close();
        Response.StatusCode=501;
        Response.End();
    }
   
    
}



